# innodb简介

`innodb`是一种使用磁盘引擎存储的引擎。工作原理是将数据划分为若干个页，以页作为磁盘和内存之间交互的基本单位，InnoDB中页的大小一般为 ***16*** KB。也就是在一般情况下，一次最少从磁盘中读取16KB的内容到内存中，一次最少把内存中的16KB内容刷新到磁盘中。

## 行格式

分别是`Compact`、`Redundant`、`Dynamic`和`Compressed`行格式

### 指定行格式语法

```sql
CREATE TABLE 表名 (列的信息) ROW_FORMAT=行格式名称
    
ALTER TABLE 表名 ROW_FORMAT=行格式名称
```

### compact格式

![image-20210916163100025](./image-20210916163100025.png)

- 变长字段长度列表

  > 倒排，用16进制存储

- NULL值列表

  > 用二进制倒排，二进制位的值为`1`时，代表该列的值为`NULL`。用16进制存储

- 记录头信息

  > 它是由固定的`5`个字节组成。`5`个字节也就是`40`个二进制位，不同的位代表不同的意思。
  >
  > ![image-20210916164525078](./image-20210916164525078.png)
  >
  > 这些二进制位代表的详细信息如下表：
  >
  > | 名称           | 大小（单位：bit） | 描述                                                         |
  > | -------------- | ----------------- | ------------------------------------------------------------ |
  > | `预留位1`      | `1`               | 没有使用                                                     |
  > | `预留位2`      | `1`               | 没有使用                                                     |
  > | `delete_mask`  | `1`               | 标记该记录是否被删除                                         |
  > | `min_rec_mask` | `1`               | B+树的每层非叶子节点中的最小记录都会添加该标记               |
  > | `n_owned`      | `4`               | 表示当前记录拥有的记录数                                     |
  > | `heap_no`      | `13`              | 表示当前记录在记录堆的位置信息                               |
  > | `record_type`  | `3`               | 表示当前记录的类型，`0`表示普通记录，`1`表示B+树非叶子节点记录，`2`表示最小记录，`3`表示最大记录 |
  > | `next_record`  | `16`              | 表示下一条记录的相对位置                                     |
  >
  > 
  >
  > 大家不要被这么多的属性和陌生的概念给吓着，我这里只是为了内容的完整性把这些位代表的意思都写了出来，现在没必要把它们的意思都记住，记住也没啥用，现在只需要看一遍混个脸熟，等之后用到这些属性的时候我们再回过头来看。

